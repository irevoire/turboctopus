<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Welcome to the Meilisearch specifications!</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.b26ff90a.css" as="style"><link rel="preload" href="/assets/js/app.4b5d26f8.js" as="script"><link rel="preload" href="/assets/js/3.4da56047.js" as="script"><link rel="preload" href="/assets/js/17.052e3dd6.js" as="script"><link rel="prefetch" href="/assets/js/10.4bb9eeac.js"><link rel="prefetch" href="/assets/js/11.72b45679.js"><link rel="prefetch" href="/assets/js/12.5c280327.js"><link rel="prefetch" href="/assets/js/13.5ee4202d.js"><link rel="prefetch" href="/assets/js/14.9305fa09.js"><link rel="prefetch" href="/assets/js/15.095125b3.js"><link rel="prefetch" href="/assets/js/16.166f3cec.js"><link rel="prefetch" href="/assets/js/18.145cf324.js"><link rel="prefetch" href="/assets/js/19.54ac2cec.js"><link rel="prefetch" href="/assets/js/20.fb03e236.js"><link rel="prefetch" href="/assets/js/21.5d4e271d.js"><link rel="prefetch" href="/assets/js/22.9d7baf38.js"><link rel="prefetch" href="/assets/js/23.06e68601.js"><link rel="prefetch" href="/assets/js/24.71bff866.js"><link rel="prefetch" href="/assets/js/25.759f5cae.js"><link rel="prefetch" href="/assets/js/26.a92885cc.js"><link rel="prefetch" href="/assets/js/27.5e7527f3.js"><link rel="prefetch" href="/assets/js/28.d2c2cee7.js"><link rel="prefetch" href="/assets/js/29.239d404a.js"><link rel="prefetch" href="/assets/js/30.05c7bec9.js"><link rel="prefetch" href="/assets/js/31.8979c09b.js"><link rel="prefetch" href="/assets/js/32.3ea84f67.js"><link rel="prefetch" href="/assets/js/33.91d80bc8.js"><link rel="prefetch" href="/assets/js/34.b5b8f566.js"><link rel="prefetch" href="/assets/js/35.6f79f9fa.js"><link rel="prefetch" href="/assets/js/36.db871ac4.js"><link rel="prefetch" href="/assets/js/37.d3f7e90f.js"><link rel="prefetch" href="/assets/js/38.bfdf6fc9.js"><link rel="prefetch" href="/assets/js/39.c0e59772.js"><link rel="prefetch" href="/assets/js/4.aaee11b0.js"><link rel="prefetch" href="/assets/js/40.d0feb147.js"><link rel="prefetch" href="/assets/js/41.1f8df8c1.js"><link rel="prefetch" href="/assets/js/42.091c877b.js"><link rel="prefetch" href="/assets/js/43.4bb7d0b6.js"><link rel="prefetch" href="/assets/js/44.437489b6.js"><link rel="prefetch" href="/assets/js/45.94f10b5f.js"><link rel="prefetch" href="/assets/js/46.28bc0390.js"><link rel="prefetch" href="/assets/js/47.49c151b7.js"><link rel="prefetch" href="/assets/js/48.b1af9c47.js"><link rel="prefetch" href="/assets/js/49.61a203fe.js"><link rel="prefetch" href="/assets/js/5.06848b4d.js"><link rel="prefetch" href="/assets/js/50.79df3dcc.js"><link rel="prefetch" href="/assets/js/51.320631dd.js"><link rel="prefetch" href="/assets/js/52.a6c5a76a.js"><link rel="prefetch" href="/assets/js/53.596da25a.js"><link rel="prefetch" href="/assets/js/54.70550584.js"><link rel="prefetch" href="/assets/js/55.166e6f41.js"><link rel="prefetch" href="/assets/js/56.a3d19c35.js"><link rel="prefetch" href="/assets/js/57.4dbfa071.js"><link rel="prefetch" href="/assets/js/58.b103820c.js"><link rel="prefetch" href="/assets/js/59.79acfddd.js"><link rel="prefetch" href="/assets/js/6.87f02c74.js"><link rel="prefetch" href="/assets/js/60.df174b2b.js"><link rel="prefetch" href="/assets/js/61.b3bf19f9.js"><link rel="prefetch" href="/assets/js/62.371c5b80.js"><link rel="prefetch" href="/assets/js/63.39c14cc1.js"><link rel="prefetch" href="/assets/js/64.e6f9b837.js"><link rel="prefetch" href="/assets/js/65.cb3ec6ff.js"><link rel="prefetch" href="/assets/js/66.76b21df9.js"><link rel="prefetch" href="/assets/js/67.0aad035d.js"><link rel="prefetch" href="/assets/js/68.7ce3facc.js"><link rel="prefetch" href="/assets/js/7.fadbe260.js"><link rel="prefetch" href="/assets/js/8.e63f62a9.js"><link rel="prefetch" href="/assets/js/9.0c014273.js"><link rel="prefetch" href="/assets/js/vendors~docs-searchbar.9a2822a3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b26ff90a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Welcome to the Meilisearch specifications!</span></a> <div class="links"><form id="search-form" role="search" class="meilisearch-search-wrapper search-box"><input id="meilisearch-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/specifications/text/specifications/text/0000-specification-template.html" class="nav-link">
  Specification
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/specifications/text/specifications/text/0000-specification-template.html" class="nav-link">
  Specification
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/specifications/text/0000-specification-template.html" class="sidebar-link">Specification template</a></li><li><a href="/specifications/text/0001-frontend-disable-prod.html" class="sidebar-link">Frontend disable prod</a></li><li><a href="/specifications/text/0001-script-based-tokenizer.html" class="sidebar-link">Script based tokenizer</a></li><li><a href="/specifications/text/0028-indexing-csv.html" class="sidebar-link">Indexing csv</a></li><li><a href="/specifications/text/0029-indexing-ndjson.html" class="sidebar-link">Indexing ndjson</a></li><li><a href="/specifications/text/0032-distinct-attribute.html" aria-current="page" class="active sidebar-link">Distinct attribute</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/specifications/text/0032-distinct-attribute.html#_1-feature-description-and-interaction" class="sidebar-link">1. Feature Description and Interaction</a></li><li class="sidebar-sub-header"><a href="/specifications/text/0032-distinct-attribute.html#_2-technical-aspects" class="sidebar-link">2. Technical Aspects</a></li><li class="sidebar-sub-header"><a href="/specifications/text/0032-distinct-attribute.html#_3-future-possibilities" class="sidebar-link">3. Future possibilities</a></li></ul></li><li><a href="/specifications/text/0033-logging.html" class="sidebar-link">Logging</a></li><li><a href="/specifications/text/0034-telemetry-policies.html" class="sidebar-link">Telemetry policies</a></li><li><a href="/specifications/text/0038-rename-attributes-for-faceting.html" class="sidebar-link">Rename attributes for faceting</a></li><li><a href="/specifications/text/0043-phrase-query.html" class="sidebar-link">Phrase query</a></li><li><a href="/specifications/text/0047-reset-stop-words-synonyms-settings-with-null.html" class="sidebar-link">Reset stop words synonyms settings with null</a></li><li><a href="/specifications/text/0048-rename-max-mdb-size-var.html" class="sidebar-link">Rename max mdb size var</a></li><li><a href="/specifications/text/0055-sort.html" class="sidebar-link">Sort</a></li><li><a href="/specifications/text/0059-geo-search.html" class="sidebar-link">Geo search</a></li><li><a href="/specifications/text/0060-tasks-api.html" class="sidebar-link">Tasks api</a></li><li><a href="/specifications/text/0061-error-format-and-definitions.html" class="sidebar-link">Error format and definitions</a></li><li><a href="/specifications/text/0077-words-position-limit.html" class="sidebar-link">Words position limit</a></li><li><a href="/specifications/text/0085-api-keys.html" class="sidebar-link">Api keys</a></li><li><a href="/specifications/text/0089-tenant-tokens.html" class="sidebar-link">Tenant tokens</a></li><li><a href="/specifications/text/0096-auto-batching.html" class="sidebar-link">Auto batching</a></li><li><a href="/specifications/text/0105-dumps-api.html" class="sidebar-link">Dumps api</a></li><li><a href="/specifications/text/0117-typo-tolerance-setting-api.html" class="sidebar-link">Typo tolerance setting api</a></li><li><a href="/specifications/text/0118-search-api.html" class="sidebar-link">Search api</a></li><li><a href="/specifications/text/0119-instance-options.html" class="sidebar-link">Instance options</a></li><li><a href="/specifications/text/0121-data-types.html" class="sidebar-link">Data types</a></li><li><a href="/specifications/text/0123-displayed-attributes-setting-api.html" class="sidebar-link">Displayed attributes setting api</a></li><li><a href="/specifications/text/0123-distinct-attribute-setting-api.html" class="sidebar-link">Distinct attribute setting api</a></li><li><a href="/specifications/text/0123-filterable-attributes-setting-api.html" class="sidebar-link">Filterable attributes setting api</a></li><li><a href="/specifications/text/0123-proximity-precision.html" class="sidebar-link">Proximity precision</a></li><li><a href="/specifications/text/0123-ranking-rules-setting-api.html" class="sidebar-link">Ranking rules setting api</a></li><li><a href="/specifications/text/0123-searchable-attributes-setting-api.html" class="sidebar-link">Searchable attributes setting api</a></li><li><a href="/specifications/text/0123-separators-settings-api.html" class="sidebar-link">Separators settings api</a></li><li><a href="/specifications/text/0123-settings-api.html" class="sidebar-link">Settings api</a></li><li><a href="/specifications/text/0123-sortable-attributes-setting-api.html" class="sidebar-link">Sortable attributes setting api</a></li><li><a href="/specifications/text/0123-stop-words-setting-api.html" class="sidebar-link">Stop words setting api</a></li><li><a href="/specifications/text/0123-synonyms-setting-api.html" class="sidebar-link">Synonyms setting api</a></li><li><a href="/specifications/text/0123-user-dictionary-settings-api.html" class="sidebar-link">User dictionary settings api</a></li><li><a href="/specifications/text/0124-documents-api.html" class="sidebar-link">Documents api</a></li><li><a href="/specifications/text/0132-indexes-api.html" class="sidebar-link">Indexes api</a></li><li><a href="/specifications/text/0134-stats-api.html" class="sidebar-link">Stats api</a></li><li><a href="/specifications/text/0135-indexing-json.html" class="sidebar-link">Indexing json</a></li><li><a href="/specifications/text/0136-documents-soft-deletion.html" class="sidebar-link">Documents soft deletion</a></li><li><a href="/specifications/text/0171-version-api.html" class="sidebar-link">Version api</a></li><li><a href="/specifications/text/0172-health-api.html" class="sidebar-link">Health api</a></li><li><a href="/specifications/text/0174-metrics-api.html" class="sidebar-link">Metrics api</a></li><li><a href="/specifications/text/0178-compression-headers.html" class="sidebar-link">Compression headers</a></li><li><a href="/specifications/text/0185-configuration-file.html" class="sidebar-link">Configuration file</a></li><li><a href="/specifications/text/0191-swap-indexes-api.html" class="sidebar-link">Swap indexes api</a></li><li><a href="/specifications/text/0192-multi-search-api.html" class="sidebar-link">Multi search api</a></li><li><a href="/specifications/text/0193-experimental-features.html" class="sidebar-link">Experimental features</a></li><li><a href="/specifications/text/0194-experimental-feature-api.html" class="sidebar-link">Experimental feature api</a></li><li><a href="/specifications/text/0195-ranking-score.html" class="sidebar-link">Ranking score</a></li><li><a href="/specifications/text/0246-facet-search-api.html" class="sidebar-link">Facet search api</a></li><li><a href="/specifications/text/0258-snapshots-api.html" class="sidebar-link">Snapshots api</a></li><li><a href="/specifications/text/0262-task-queue-webhook.html" class="sidebar-link">Task queue webhook</a></li><li><a href="/specifications/text/157-faceting-setting-api.html" class="sidebar-link">Aceting setting api</a></li><li><a href="/specifications/text/157-pagination-setting-api.html" class="sidebar-link">Agination setting api</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><ul><li>Title: Distinct Attribute</li> <li>Start Date: 2021-04-16</li> <li>Specification PR: <a href="https://github.com/meilisearch/specifications/pull/32" target="_blank" rel="noopener noreferrer">#32<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>MeiliSearch Tracking-Issues: <a href="https://github.com/meilisearch/milli/issues/168" target="_blank" rel="noopener noreferrer">milli#168<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h1 id="distinct-attribute"><a href="#distinct-attribute" class="header-anchor">#</a> Distinct Attribute</h1> <h2 id="_1-feature-description-and-interaction"><a href="#_1-feature-description-and-interaction" class="header-anchor">#</a> 1. Feature Description and Interaction</h2> <h3 id="i-summary"><a href="#i-summary" class="header-anchor">#</a> I. Summary</h3> <p>The distinct attribute is usefull to discard other occurences of document having the same value as the field setted as a distinct attribute.</p> <p>The value of a field whose attribute is set as a distinct attribute will always be unique in the returned documents.</p> <h3 id="ii-motivation"><a href="#ii-motivation" class="header-anchor">#</a> II. Motivation</h3> <p>The new search engine called Milli no longer processes the distinct attribute as the current MeilliSearch. The specification aims to make Milli as backward compatible as possible with the current release (v.0.20.0). Including both the API usage and the expected search results.</p> <h3 id="iii-additional-materials"><a href="#iii-additional-materials" class="header-anchor">#</a> III. Additional Materials</h3> <h4 id="algolia"><a href="#algolia" class="header-anchor">#</a> Algolia</h4> <p>Algolia distinct feature is based on one attribute, as defined in <code>attributeForDistinct</code>.
Adding an attribute to this setting will make that all search results have a different value in the given attributes field. This is done at indexing time.</p> <p>Algolia distinct functionality enables deduplication and aggregation by allowing a numeric value for the defined distinct attribute.</p> <table><thead><tr><th>Behavior</th> <th>Distinct value</th> <th>Description</th></tr></thead> <tbody><tr><td>de-duplication</td> <td>N = 1</td> <td>Used to remove similar records from the search result. Only the most relevant record is returned.</td></tr> <tr><td>grouping</td> <td>N &gt; 1</td> <td>N records containing the same value for the distinct attribute will be returned.</td></tr></tbody></table> <blockquote><p><code>distinct</code> is silently ignored at query time if <code>attibuteForDistinct</code> is not defined. It is not mandatory but possible to set <code>distinct</code> at indexing time via the index settings endpoint.</p> <p>It is possible to disable distinct feature at query time, by giving a falsy value (<code>false</code> or <code>O</code>) for the distinct parameter. Giving <code>true</code> is equivalent to <code>1</code>.</p></blockquote> <h4 id="typesense"><a href="#typesense" class="header-anchor">#</a> TypeSense</h4> <p>TypeSense distinct feature uses <code>group_by</code> and <code>group_limit</code> to achieve de-duplication and grouping at query time.</p> <blockquote><p>A field that is setted as a parameter of group_by must be previously faceted.</p></blockquote> <table><thead><tr><th>Parameter</th> <th>Description</th></tr></thead> <tbody><tr><td>group_by</td> <td>It is possible to aggregate records into groups by setting multiple fields separated by a comma. E.g. group_by=country,company_name</td></tr> <tr><td>group_limit</td> <td>Control the maximum number of top records returned for groups. By default, TypeSense <code>group_limit</code> parameter is set to 3.</td></tr></tbody></table> <p>Using group_by add a nested structure in the search result. Buckets are returned in <code>grouped_hits</code> field.</p> <h4 id="elasticsearch"><a href="#elasticsearch" class="header-anchor">#</a> ElasticSearch</h4> <p>Elasticsearch does not provide this functionality directly. Nor a keyword or an operator exists to get de-duplicated or grouped results.</p> <p>It is difficult to find the information in the official documentation. A lot of people are asking about the distinct feature on StackOverflow or ElasticSearch forums.</p> <p>By specifying the search with terms or composite aggregations it is possible to have buckets fed by documents that have the same values on a specified field.</p> <p>E.g Terms aggregation</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;distinct_colors&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;terms&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;color&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">1000</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The size parameter can be set to define how many term buckets should be returned out of the overall terms list. Term aggregations by default return 10 buckets only.</p> <p>Composite aggregation allows to paginate over buckets containing a lot of values.</p> <blockquote><p>Cardinality aggregation can calculates the count of distinct values for a field.</p></blockquote> <p>It is also possible to use the keyword <code>DISTINCT</code> from the SQL access feature from X-Pack. However the functionality only allows to return tabular data.</p> <h3 id="iv-explanation"><a href="#iv-explanation" class="header-anchor">#</a> IV.Explanation</h3> <p>Let's say that we have 2 documents with the same <code>product_id</code>. Each document exists to materialize the color variation.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;colors&quot;</span><span class="token operator">:</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token property">&quot;label&quot;</span><span class="token operator">:</span> <span class="token string">&quot;t-shirt&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;product_id&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;colors&quot;</span><span class="token operator">:</span> <span class="token string">&quot;black&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token property">&quot;label&quot;</span><span class="token operator">:</span> <span class="token string">&quot;t-shirt&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;product_id&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;offset&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;limit&quot;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token property">&quot;nbHits&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;exhaustiveNbHits&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;processingTimeMs&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;t-shirt&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Without setting <code>product_id</code> as a distinct attribute, a search with <code>t-shirt</code> as a query will return the two documents.</p> <p>It can be useful to display one product per color variation as a search result for example. But as your number of products variations grows over time, you might want to display only one result as a top search result, mostly for UI concerns.</p> <p>It's in this case that the distinct attribute finds all its interest.</p> <p>Setting <code>product_id</code> as a distinct attribute will discard all others documents having the same value for <code>product_id</code> from the search result.</p> <h4 id="distinct-attribute-in-v0-20"><a href="#distinct-attribute-in-v0-20" class="header-anchor">#</a> Distinct Attribute in v0.20</h4> <blockquote><p>MeiliSearch accepts only one value which is the document attribute that needs to be de-duplicated from the other document sharing the same attribute value.</p></blockquote> <p>It is possible to configure the distinct attribute using two endpoints. <a href="https://docs.meilisearch.com/reference/api/settings.html#update-settings" target="_blank" rel="noopener noreferrer">Update All Settings<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and the <a href="https://docs.meilisearch.com/reference/api/distinct_attribute.html#update-distinct-attribute" target="_blank" rel="noopener noreferrer">distinct attribute<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> endpoint.</p> <p>Given this setting :</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;distinctAttribute&quot;</span><span class="token operator">:</span> <span class="token string">&quot;product_id&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>MeiliSearch will return de-duplicated hits by <code>product_id</code>.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;colors&quot;</span><span class="token operator">:</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token property">&quot;label&quot;</span><span class="token operator">:</span> <span class="token string">&quot;t-shirt&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;product_id&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;offset&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;limit&quot;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token property">&quot;nbHits&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;exhaustiveNbHits&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;processingTimeMs&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\&quot;t-shirt\&quot;&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>It returns the top most relevant document by discarding all the others.</p> <p>For a search with <code>&quot;q&quot;: &quot;black&quot;</code> as parameter, MeiliSearch returns:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;colors&quot;</span><span class="token operator">:</span> <span class="token string">&quot;black&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token property">&quot;label&quot;</span><span class="token operator">:</span> <span class="token string">&quot;t-shirt&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;product_id&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;offset&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;limit&quot;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token property">&quot;nbHits&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;exhaustiveNbHits&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;processingTimeMs&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\&quot;black\&quot;&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="distinct-attribute-in-0-21-milli"><a href="#distinct-attribute-in-0-21-milli" class="header-anchor">#</a> Distinct Attribute in 0.21 (Milli)</h4> <p>Milli shoud be identical as v.0.20 concerning API endpoints and returned results.</p> <h3 id="v-impact-on-documentation"><a href="#v-impact-on-documentation" class="header-anchor">#</a> V. Impact on documentation</h3> <p>N/A</p> <h3 id="vi-impact-on-sdks"><a href="#vi-impact-on-sdks" class="header-anchor">#</a> VI. Impact on SDKs</h3> <p>N/A</p> <h2 id="_2-technical-aspects"><a href="#_2-technical-aspects" class="header-anchor">#</a> 2. Technical Aspects</h2> <h3 id="abstract"><a href="#abstract" class="header-anchor">#</a> Abstract</h3> <p>To apply the distinct behavior, the search engine needs to create a database. This database is the same as we create to apply facets and filters on an attribute. However, the users will not pass the attribute into <code>attributesForFaceting</code> when setting a distinct attribute. It means the search engine must create this database for the related attribute.</p> <p>Following this example, it also means the search engine would be technically able to apply filters and facet distribution on the distinct attribute, however, we should prevent this. To avoid confusion, the search engine should prevent the users to execute a filter or get facet distribution on the distinct attribute. Only the distinct capability should be available for this field.</p> <p>If the user wants to filter on that attribute, he will have to add it in <code>attributesForFaceting</code> as well.</p> <p>Using this new data structure allows interesting future possibilities.</p> <h2 id="_3-future-possibilities"><a href="#_3-future-possibilities" class="header-anchor">#</a> 3. Future possibilities</h2> <blockquote><p>These ideas will be materialized as feature-proposals in the product team backlog. Keep in mind that this specification is related to v0.21.</p></blockquote> <h3 id="grouping"><a href="#grouping" class="header-anchor">#</a> Grouping</h3> <h4 id="distinct-count-to-enable-grouping-feature"><a href="#distinct-count-to-enable-grouping-feature" class="header-anchor">#</a> Distinct count to enable grouping feature</h4> <p>Since MeiliSearch can only de-duplicate documents matching the distinct attribute, it would be interesting to be able to set the number of topmost relevant documents before discarding the others.</p> <p><code>groupLimit</code> could be applied at search time to fit users needs.</p> <h4 id="distinct-on-multiple-fields"><a href="#distinct-on-multiple-fields" class="header-anchor">#</a> Distinct on multiple fields</h4> <blockquote><p>It probably require to add a nested structure to return hits for each groups with clarity.</p></blockquote> <h5 id="indexing-time"><a href="#indexing-time" class="header-anchor">#</a> Indexing time</h5> <p>Given this distinct setting:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;distinctAttributes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;colors&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;size&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="search-time"><a href="#search-time" class="header-anchor">#</a> Search time</h5> <p>We could add a <code>groupBy</code> like parameter to let the user choose a specific grouping behavior:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;groupBy&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;colors&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>or</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;groupBy&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;size&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;colors&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>It can be used in combination with groupLimit to define the topmost relevant documents before discarding the others for each group.</p></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/specifications/text/0029-indexing-ndjson.html" class="prev">
        Indexing ndjson
      </a></span> <span class="next"><a href="/specifications/text/0033-logging.html">
        Logging
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4b5d26f8.js" defer></script><script src="/assets/js/3.4da56047.js" defer></script><script src="/assets/js/17.052e3dd6.js" defer></script>
  </body>
</html>
