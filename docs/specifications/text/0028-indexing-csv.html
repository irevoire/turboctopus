<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Welcome to the Meilisearch specifications!</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.b26ff90a.css" as="style"><link rel="preload" href="/assets/js/app.e6676148.js" as="script"><link rel="preload" href="/assets/js/3.4da56047.js" as="script"><link rel="preload" href="/assets/js/15.095125b3.js" as="script"><link rel="prefetch" href="/assets/js/10.4bb9eeac.js"><link rel="prefetch" href="/assets/js/11.72b45679.js"><link rel="prefetch" href="/assets/js/12.2af66f08.js"><link rel="prefetch" href="/assets/js/13.167021d3.js"><link rel="prefetch" href="/assets/js/14.9305fa09.js"><link rel="prefetch" href="/assets/js/16.166f3cec.js"><link rel="prefetch" href="/assets/js/17.052e3dd6.js"><link rel="prefetch" href="/assets/js/18.145cf324.js"><link rel="prefetch" href="/assets/js/19.54ac2cec.js"><link rel="prefetch" href="/assets/js/20.fe442e43.js"><link rel="prefetch" href="/assets/js/21.01b56736.js"><link rel="prefetch" href="/assets/js/22.9d7baf38.js"><link rel="prefetch" href="/assets/js/23.06e68601.js"><link rel="prefetch" href="/assets/js/24.71bff866.js"><link rel="prefetch" href="/assets/js/25.759f5cae.js"><link rel="prefetch" href="/assets/js/26.719ff326.js"><link rel="prefetch" href="/assets/js/27.178e5c36.js"><link rel="prefetch" href="/assets/js/28.d2c2cee7.js"><link rel="prefetch" href="/assets/js/29.239d404a.js"><link rel="prefetch" href="/assets/js/30.06e60030.js"><link rel="prefetch" href="/assets/js/31.7ce04ec7.js"><link rel="prefetch" href="/assets/js/32.3d0e4e96.js"><link rel="prefetch" href="/assets/js/33.91d80bc8.js"><link rel="prefetch" href="/assets/js/34.1ae80f5b.js"><link rel="prefetch" href="/assets/js/35.09e8f62f.js"><link rel="prefetch" href="/assets/js/36.15b16bf9.js"><link rel="prefetch" href="/assets/js/37.1d009b1c.js"><link rel="prefetch" href="/assets/js/38.651ab4ec.js"><link rel="prefetch" href="/assets/js/39.3ffdfa45.js"><link rel="prefetch" href="/assets/js/4.aaee11b0.js"><link rel="prefetch" href="/assets/js/40.d707c5be.js"><link rel="prefetch" href="/assets/js/41.65027914.js"><link rel="prefetch" href="/assets/js/42.0ada06ba.js"><link rel="prefetch" href="/assets/js/43.af7cbf45.js"><link rel="prefetch" href="/assets/js/44.d3d1a586.js"><link rel="prefetch" href="/assets/js/45.94f10b5f.js"><link rel="prefetch" href="/assets/js/46.9e997213.js"><link rel="prefetch" href="/assets/js/47.49c151b7.js"><link rel="prefetch" href="/assets/js/48.b1af9c47.js"><link rel="prefetch" href="/assets/js/49.61a203fe.js"><link rel="prefetch" href="/assets/js/5.06848b4d.js"><link rel="prefetch" href="/assets/js/50.5561182d.js"><link rel="prefetch" href="/assets/js/51.320631dd.js"><link rel="prefetch" href="/assets/js/52.b777542a.js"><link rel="prefetch" href="/assets/js/53.f57a89e9.js"><link rel="prefetch" href="/assets/js/54.aab35d92.js"><link rel="prefetch" href="/assets/js/55.16d1a9db.js"><link rel="prefetch" href="/assets/js/56.f8afd4eb.js"><link rel="prefetch" href="/assets/js/57.6e1d5d7b.js"><link rel="prefetch" href="/assets/js/58.b103820c.js"><link rel="prefetch" href="/assets/js/59.79acfddd.js"><link rel="prefetch" href="/assets/js/6.87f02c74.js"><link rel="prefetch" href="/assets/js/60.df174b2b.js"><link rel="prefetch" href="/assets/js/61.6a669f3a.js"><link rel="prefetch" href="/assets/js/62.3ac8f506.js"><link rel="prefetch" href="/assets/js/63.39c14cc1.js"><link rel="prefetch" href="/assets/js/64.53965336.js"><link rel="prefetch" href="/assets/js/65.509d9e2e.js"><link rel="prefetch" href="/assets/js/66.74682a96.js"><link rel="prefetch" href="/assets/js/67.6322aeae.js"><link rel="prefetch" href="/assets/js/68.7ce3facc.js"><link rel="prefetch" href="/assets/js/7.fadbe260.js"><link rel="prefetch" href="/assets/js/8.e63f62a9.js"><link rel="prefetch" href="/assets/js/9.0c014273.js"><link rel="prefetch" href="/assets/js/vendors~docs-searchbar.9a2822a3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b26ff90a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Welcome to the Meilisearch specifications!</span></a> <div class="links"><form id="search-form" role="search" class="meilisearch-search-wrapper search-box"><input id="meilisearch-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/specifications/text/specifications/text/0000-specification-template.html" class="nav-link">
  Specification
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/specifications/text/specifications/text/0000-specification-template.html" class="nav-link">
  Specification
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/specifications/text/0000-specification-template.html" class="sidebar-link">Specification template</a></li><li><a href="/specifications/text/0001-frontend-disable-prod.html" class="sidebar-link">Frontend disable prod</a></li><li><a href="/specifications/text/0001-script-based-tokenizer.html" class="sidebar-link">Script based tokenizer</a></li><li><a href="/specifications/text/0028-indexing-csv.html" aria-current="page" class="active sidebar-link">Indexing csv</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/specifications/text/0028-indexing-csv.html#_1-functional-specification" class="sidebar-link">1. Functional Specification</a></li><li class="sidebar-sub-header"><a href="/specifications/text/0028-indexing-csv.html#missing-content-type" class="sidebar-link">missingcontenttype</a></li><li class="sidebar-sub-header"><a href="/specifications/text/0028-indexing-csv.html#invalid-content-type" class="sidebar-link">invalidcontenttype</a></li><li class="sidebar-sub-header"><a href="/specifications/text/0028-indexing-csv.html#missing-payload" class="sidebar-link">missing_payload</a></li><li class="sidebar-sub-header"><a href="/specifications/text/0028-indexing-csv.html#malformed-payload" class="sidebar-link">malformed_payload</a></li><li class="sidebar-sub-header"><a href="/specifications/text/0028-indexing-csv.html#_2-technical-details" class="sidebar-link">2. Technical details</a></li><li class="sidebar-sub-header"><a href="/specifications/text/0028-indexing-csv.html#_3-future-possibilities" class="sidebar-link">3. Future possibilities</a></li></ul></li><li><a href="/specifications/text/0029-indexing-ndjson.html" class="sidebar-link">Indexing ndjson</a></li><li><a href="/specifications/text/0032-distinct-attribute.html" class="sidebar-link">Distinct attribute</a></li><li><a href="/specifications/text/0033-logging.html" class="sidebar-link">Logging</a></li><li><a href="/specifications/text/0034-telemetry-policies.html" class="sidebar-link">Telemetry policies</a></li><li><a href="/specifications/text/0038-rename-attributes-for-faceting.html" class="sidebar-link">Rename attributes for faceting</a></li><li><a href="/specifications/text/0043-phrase-query.html" class="sidebar-link">Phrase query</a></li><li><a href="/specifications/text/0047-reset-stop-words-synonyms-settings-with-null.html" class="sidebar-link">Reset stop words synonyms settings with null</a></li><li><a href="/specifications/text/0048-rename-max-mdb-size-var.html" class="sidebar-link">Rename max mdb size var</a></li><li><a href="/specifications/text/0055-sort.html" class="sidebar-link">Sort</a></li><li><a href="/specifications/text/0059-geo-search.html" class="sidebar-link">Geo search</a></li><li><a href="/specifications/text/0060-tasks-api.html" class="sidebar-link">Tasks api</a></li><li><a href="/specifications/text/0061-error-format-and-definitions.html" class="sidebar-link">Error format and definitions</a></li><li><a href="/specifications/text/0077-words-position-limit.html" class="sidebar-link">Words position limit</a></li><li><a href="/specifications/text/0085-api-keys.html" class="sidebar-link">Api keys</a></li><li><a href="/specifications/text/0089-tenant-tokens.html" class="sidebar-link">Tenant tokens</a></li><li><a href="/specifications/text/0096-auto-batching.html" class="sidebar-link">Auto batching</a></li><li><a href="/specifications/text/0105-dumps-api.html" class="sidebar-link">Dumps api</a></li><li><a href="/specifications/text/0117-typo-tolerance-setting-api.html" class="sidebar-link">Typo tolerance setting api</a></li><li><a href="/specifications/text/0118-search-api.html" class="sidebar-link">Search api</a></li><li><a href="/specifications/text/0119-instance-options.html" class="sidebar-link">Instance options</a></li><li><a href="/specifications/text/0121-data-types.html" class="sidebar-link">Data types</a></li><li><a href="/specifications/text/0123-displayed-attributes-setting-api.html" class="sidebar-link">Displayed attributes setting api</a></li><li><a href="/specifications/text/0123-distinct-attribute-setting-api.html" class="sidebar-link">Distinct attribute setting api</a></li><li><a href="/specifications/text/0123-filterable-attributes-setting-api.html" class="sidebar-link">Filterable attributes setting api</a></li><li><a href="/specifications/text/0123-proximity-precision.html" class="sidebar-link">Proximity precision</a></li><li><a href="/specifications/text/0123-ranking-rules-setting-api.html" class="sidebar-link">Ranking rules setting api</a></li><li><a href="/specifications/text/0123-searchable-attributes-setting-api.html" class="sidebar-link">Searchable attributes setting api</a></li><li><a href="/specifications/text/0123-separators-settings-api.html" class="sidebar-link">Separators settings api</a></li><li><a href="/specifications/text/0123-settings-api.html" class="sidebar-link">Settings api</a></li><li><a href="/specifications/text/0123-sortable-attributes-setting-api.html" class="sidebar-link">Sortable attributes setting api</a></li><li><a href="/specifications/text/0123-stop-words-setting-api.html" class="sidebar-link">Stop words setting api</a></li><li><a href="/specifications/text/0123-synonyms-setting-api.html" class="sidebar-link">Synonyms setting api</a></li><li><a href="/specifications/text/0123-user-dictionary-settings-api.html" class="sidebar-link">User dictionary settings api</a></li><li><a href="/specifications/text/0124-documents-api.html" class="sidebar-link">Documents api</a></li><li><a href="/specifications/text/0132-indexes-api.html" class="sidebar-link">Indexes api</a></li><li><a href="/specifications/text/0134-stats-api.html" class="sidebar-link">Stats api</a></li><li><a href="/specifications/text/0135-indexing-json.html" class="sidebar-link">Indexing json</a></li><li><a href="/specifications/text/0136-documents-soft-deletion.html" class="sidebar-link">Documents soft deletion</a></li><li><a href="/specifications/text/0171-version-api.html" class="sidebar-link">Version api</a></li><li><a href="/specifications/text/0172-health-api.html" class="sidebar-link">Health api</a></li><li><a href="/specifications/text/0174-metrics-api.html" class="sidebar-link">Metrics api</a></li><li><a href="/specifications/text/0178-compression-headers.html" class="sidebar-link">Compression headers</a></li><li><a href="/specifications/text/0185-configuration-file.html" class="sidebar-link">Configuration file</a></li><li><a href="/specifications/text/0191-swap-indexes-api.html" class="sidebar-link">Swap indexes api</a></li><li><a href="/specifications/text/0192-multi-search-api.html" class="sidebar-link">Multi search api</a></li><li><a href="/specifications/text/0193-experimental-features.html" class="sidebar-link">Experimental features</a></li><li><a href="/specifications/text/0194-experimental-feature-api.html" class="sidebar-link">Experimental feature api</a></li><li><a href="/specifications/text/0195-ranking-score.html" class="sidebar-link">Ranking score</a></li><li><a href="/specifications/text/0246-facet-search-api.html" class="sidebar-link">Facet search api</a></li><li><a href="/specifications/text/0258-snapshots-api.html" class="sidebar-link">Snapshots api</a></li><li><a href="/specifications/text/0262-task-queue-webhook.html" class="sidebar-link">Task queue webhook</a></li><li><a href="/specifications/text/157-faceting-setting-api.html" class="sidebar-link">Aceting setting api</a></li><li><a href="/specifications/text/157-pagination-setting-api.html" class="sidebar-link">Agination setting api</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><ul><li>Title: Indexing CSV</li> <li>Start Date: 2021-04-9</li> <li>Specification PR: <a href="https://github.com/Meilisearch/specifications/pull/28" target="_blank" rel="noopener noreferrer">PR-#28<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Discovery Issue: n/a</li></ul> <h1 id="indexing-csv"><a href="#indexing-csv" class="header-anchor">#</a> Indexing CSV</h1> <h2 id="_1-functional-specification"><a href="#_1-functional-specification" class="header-anchor">#</a> 1. Functional Specification</h2> <h3 id="i-summary"><a href="#i-summary" class="header-anchor">#</a> I. Summary</h3> <p>To index documents, the body of the add documents request has to match a specific format. That specific format is then parsed and tokenized inside Meilisearch. After which, the documents added are in the pool of searchable and returnable documents.</p> <p>A <a href="https://en.wikipedia.org/wiki/Comma-separated_values" target="_blank" rel="noopener noreferrer">CSV<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> data format is broadly used to store and exchange data in a simple format.</p> <p>Also, in order to boost write performance CSV data format is more suited than JSON for consequent datasets, as keys are not duplicated for every document.</p> <h4 id="summary-key-points"><a href="#summary-key-points" class="header-anchor">#</a> Summary Key Points</h4> <ul><li>The header of the csv payload allows to name the attributes and type them.</li> <li><code>text/csv</code> Content-Type header is now supported.</li> <li>A new query parameter, <code>csvDelimiter</code>, has been introduced to customize the csv delimiter used in the document. It can change between two <code>documentAddition</code>.</li> <li>The error cases have been strengthened and completed. See Errors part.</li></ul> <h3 id="ii-motivation"><a href="#ii-motivation" class="header-anchor">#</a> II. Motivation</h3> <p>We want to provide our users with an always improved usage experience. Currently, the engine only accepts JSON format as a data source. We want to give users the possibility of another simple data format, well known, to use. Thus, give them more versatility at the data source choices for the indexing (add and update) step.</p> <p>Since most SQL engines or SQL clients can easily dump data as CSV, it will facilitate Meilisearch adoption by extending the indexing step on a wider range of customer cases than before.</p> <p>Writing performance is also considered as a motivation since CSV parsing is less CPU and memory intensive than parsing Json due to the streamable capability of the CSV format.</p> <h3 id="iii-explanation"><a href="#iii-explanation" class="header-anchor">#</a> III.Explanation</h3> <h4 id="csv-formatting-rules"><a href="#csv-formatting-rules" class="header-anchor">#</a> CSV Formatting Rules</h4> <p>While there's <a href="https://tools.ietf.org/html/rfc4180" target="_blank" rel="noopener noreferrer">RFC 4180<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> as a try to add a specification for CSV format, we will find a lot of variations from that. Meilisearch features capabilities requires CSV data to be formatted the proper way to be parsable by the engine.</p> <ul><li>CSV data format needs to contain a first line representing the list of attributes with the optionally chosen type separated from the attribute name by <code>:</code> character. The type is case insensitive.</li></ul> <blockquote><p>An attribute can be specificed with three types: <code>string</code>, <code>boolean</code> or <code>number</code>. A missing type will be interpreted as a <code>string</code> by default.</p> <p>Valid headline example: &quot;id:number&quot;,&quot;title:string&quot;,&quot;author&quot;,&quot;price:number&quot;,&quot;cute:boolean&quot;</p></blockquote> <ul><li>The following CSV lines will represent a document for Meilisearch.</li> <li>A <code>,</code> character must separate each cell.</li> <li>A CSV value should be enclosed in double-quotes when it contains the delimiter character or a newline to escape it.</li> <li>Using double-quotes to enclose fields, then a double-quote appearing inside a field must be escaped by preceding it with another double quote as mentioned in <a href="https://tools.ietf.org/html/rfc4180" target="_blank" rel="noopener noreferrer">RFC 4180<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li> <li>Float value should be written with a <code>.</code> character, like <code>3.14</code>.</li> <li>CSV text should be encoded in UTF8.</li> <li>The format can't handle array cell values. We are providing <code>nd-json</code> format to deal with theses types of attribute in a easier way.</li> <li>A <code>csvDelimiter</code> query parameter is available to customize the delimiter used in the documents.
<ul><li>This <code>csvDelimiter</code> is optional. By default, the <code>,</code> character is used.</li> <li>The separator must be one <a href="https://www.rfc-editor.org/rfc/rfc20" target="_blank" rel="noopener noreferrer">ascii char<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li> <li>The separator can't be used with another Content-Type, or else it'll throw an error.</li></ul></li></ul> <h5 id="null-value"><a href="#null-value" class="header-anchor">#</a> <code>null</code> value</h5> <ul><li>If a field is of type <code>string</code>, then an empty cell is considered as a <code>null</code> value (e.g. <code>,,</code>), anything else is turned into a string value (e.g. <code>, ,</code> is a single whitespace string)</li> <li>If a field is of type <code>number</code>, when the trimmed field is empty, it's considered as a <code>null</code> value (e.g. <code>,,</code> <code>, ,</code>); otherwise, Meilisearch tries to parse the number.</li> <li>If a field is of type <code>boolean</code>, when the trimmed field is empty, it's considered as a <code>null</code> value (e.g. <code>,,</code> <code>, ,</code>); otherwise, Meilisearch tries to parse the boolean as either <code>true</code> or <code>false</code>.</li></ul> <h5 id="example-with-a-comma-inside-a-cell"><a href="#example-with-a-comma-inside-a-cell" class="header-anchor">#</a> Example with a comma inside a cell</h5> <p>Given the CSV payload</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;id:number&quot;,&quot;label&quot;,&quot;price:number&quot;,&quot;colors&quot;,&quot;description&quot;,&quot;contains_a_dog_picture:boolean&quot;
&quot;1&quot;,&quot;t-shirt&quot;,&quot;4.99&quot;,&quot;red&quot;,&quot;Thus, you will rock at summer time.&quot;,&quot;false&quot;
</code></pre></div><p>the search result should be displayed as</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">&quot;label&quot;</span><span class="token operator">:</span> <span class="token string">&quot;t-shirt&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">4.99</span><span class="token punctuation">,</span>
      <span class="token property">&quot;colors&quot;</span><span class="token operator">:</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Thus, you will rock at summer time.&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;contains_a_dog_picture&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  ...
<span class="token punctuation">}</span>
</code></pre></div><h5 id="example-with-a-double-quote-inside-a-cell"><a href="#example-with-a-double-quote-inside-a-cell" class="header-anchor">#</a> Example with a double quote inside a cell</h5> <p>Given the CSV payload</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;id:number&quot;,&quot;label&quot;,&quot;price&quot;,&quot;colors&quot;,&quot;description&quot;
&quot;1&quot;,&quot;t-shirt&quot;,&quot;4.99&quot;,&quot;red&quot;,&quot;Hey, you will &quot;&quot;rock&quot;&quot; at summer time.&quot;
</code></pre></div><p>the search result should be displayed as</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">&quot;label&quot;</span><span class="token operator">:</span> <span class="token string">&quot;t-shirt&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4.99&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;colors&quot;</span><span class="token operator">:</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Hey, you will rock at summer time.&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  ...
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>Note that the price attribute was not typed as a number. By default, Meilisearch type it as a string.</p></blockquote> <h5 id="example-with-an-empty-cell"><a href="#example-with-an-empty-cell" class="header-anchor">#</a> Example with an empty cell</h5> <p>Given the CSV payload</p> <div class="language- extra-class"><pre class="language-text"><code>id:number,label,price:number,colors
1,t-shirt,,red
</code></pre></div><p>the search result should be displayed as</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">&quot;label&quot;</span><span class="token operator">:</span> <span class="token string">&quot;t-shirt&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
      <span class="token property">&quot;colors&quot;</span><span class="token operator">:</span> <span class="token string">&quot;red&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  ...
<span class="token punctuation">}</span>
</code></pre></div><h4 id="api-endpoints"><a href="#api-endpoints" class="header-anchor">#</a> API Endpoints</h4> <blockquote><p>Each API endpoints mentioned above will now require a <code>text/csv</code> as <code>Content-Type</code> header to be processed as CSV data.</p></blockquote> <p><strong>As a developer, I want to upload a CSV payload of documents so that end-user can search them</strong></p> <p><strong>POST documents</strong> <code>/indexes/:indexUid/documents</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> <span class="token punctuation">\</span>
  -X POST <span class="token string">'http://localhost:7700/indexes/movies/documents'</span> <span class="token punctuation">\</span>
  -H <span class="token string">'Content-Type: text/csv'</span> <span class="token punctuation">\</span>
  --data--binary <span class="token string">'
    &quot;id&quot;,&quot;label&quot;,&quot;price:number&quot;,&quot;colors&quot;,&quot;description&quot;\n
    &quot;1&quot;,&quot;hoodie&quot;,&quot;19.99&quot;,&quot;purple&quot;,&quot;Hey, you will rock at summer time.&quot;
  '</span>
</code></pre></div><blockquote><p>202 Accepted - Response</p></blockquote> <p><strong>PUT documents</strong> <code>/indexes/:indexUid/documents</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> <span class="token punctuation">\</span>
  -X PUT <span class="token string">'http://localhost:7700/indexes/movies/documents'</span> <span class="token punctuation">\</span>
  -H <span class="token string">'Content-Type: text/csv'</span> <span class="token punctuation">\</span>
  --data-binary <span class="token string">'
    &quot;id&quot;,&quot;label&quot;,&quot;price:number&quot;,&quot;colors&quot;,&quot;description&quot;\n
    &quot;1&quot;,&quot;hoodie&quot;,&quot;19.99&quot;,&quot;purple&quot;,&quot;Hey, you will rock at summer time.&quot;
  '</span>
</code></pre></div><blockquote><p>202 Accepted - Response</p></blockquote> <h5 id="errors"><a href="#errors" class="header-anchor">#</a> Errors</h5> <ul><li>🔴 Omitted <code>Content-Type</code> header will lead to a 415 Unsupported Media Type - <strong>missing_content_type</strong> error code.</li> <li>🔴 Sending an empty <code>Content-Type</code> will lead to a 415 Unsupported Media Type - <strong>invalid_content_type</strong> error code.</li> <li>🔴 Sending a different <code>Content-Type</code> than <code>application/json</code>, <code>application/x-ndjson</code> or <code>text/csv</code> will lead to 415 Unsupported Media Type  <strong>invalid_content_type</strong> error code.</li> <li>🔴 Sending an empty payload will lead to a 400 Bad Request - <strong>missing_payload</strong> error code.</li> <li>🔴 Sending a different payload type than the <code>Content-Type</code> header should return a 400 Bad Request - <strong>malformed_payload</strong> error code.</li> <li>🔴 Sending a payload excessing the limit will lead to a 413 Payload Too Large - <strong>payload_too_large</strong> error code.</li> <li>🔴 Sending an invalid CSV format will lead to a 400 bad_request - <strong>malformed_payload</strong> error code.</li> <li>🔴 Sending a CSV header that does not conform to the specification will lead to a 400 bad_request - <strong>malformed_payload</strong> error code.</li> <li>🔴 Sending an invalid csv delimiter: not exactly one ASCII char. This will lead to a 400 bad_request - <strong>invalid_document_csv_delimiter</strong> error code.</li> <li>🔴 Sending a CSV cell with the type <code>number</code> or <code>boolean</code> that can't be parsed will lead to a 400 bad_request - <strong>malformed_payload</strong> error code.</li></ul> <h5 id="errors-definition"><a href="#errors-definition" class="header-anchor">#</a> Errors Definition</h5> <h2 id="missing-content-type"><a href="#missing-content-type" class="header-anchor">#</a> missing_content_type</h2> <h3 id="context"><a href="#context" class="header-anchor">#</a> Context</h3> <p>This error occurs when the Content-Type header is missing.</p> <h3 id="error-definition"><a href="#error-definition" class="header-anchor">#</a> Error Definition</h3> <p>HTTP Code: <code>415 Unsupported Media Type</code></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;A Content-Type header is missing. Accepted values for Content-Type are: :contentTypeList&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;missing_content_type&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;invalid_request&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;link&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://docs.meilisearch.com/errors#missing_content_type&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>The <code>:contentTypeList</code> is inferred when the message is generated. The values are separated by a <code>,</code> char. e.g. <code>application/json</code>, <code>text/csv</code>.</li></ul> <hr> <h2 id="invalid-content-type"><a href="#invalid-content-type" class="header-anchor">#</a> invalid_content_type</h2> <h3 id="context-2"><a href="#context-2" class="header-anchor">#</a> Context</h3> <p>This error occurs when the provided content-type is not handled by the API method.</p> <h3 id="error-definition-2"><a href="#error-definition-2" class="header-anchor">#</a> Error Definition</h3> <p>HTTP Code: <code>415 Unsupported Media Type</code></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;The Content-Type :contentType is invalid. Accepted values for Content-Type are: :contentTypeList&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;invalid_content_type&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;invalid_request&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;link&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://docs.meilisearch.com/errors#invalid_content_type&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>The <code>:contentTypeList</code> is inferred when the message is generated. The values are separated by a <code>,</code> char. e.g. <code>application/json</code>, <code>text/csv</code>.</li></ul> <hr> <h2 id="missing-payload"><a href="#missing-payload" class="header-anchor">#</a> missing_payload</h2> <h3 id="context-3"><a href="#context-3" class="header-anchor">#</a> Context</h3> <p>This error occurs when the client does not provide a mandatory payload to the request.</p> <h3 id="error-definition-3"><a href="#error-definition-3" class="header-anchor">#</a> Error Definition</h3> <p>HTTP Code: <code>400 Bad Request</code></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;A :payloadType payload is missing.&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;missing_payload&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;invalid_request&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;link&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://docs.meilisearch.com/errors#missing_payload&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>The <code>:payloadType</code> is inferred when the message is generated. e.g. <code>json</code>, <code>ndjson</code>, <code>csv</code></li></ul> <hr> <h2 id="malformed-payload"><a href="#malformed-payload" class="header-anchor">#</a> malformed_payload</h2> <h3 id="context-4"><a href="#context-4" class="header-anchor">#</a> Context</h3> <p>This error occurs when the format sent in the payload is malformed. The payload contains a syntax error.</p> <h3 id="error-definition-4"><a href="#error-definition-4" class="header-anchor">#</a> Error Definition</h3> <p>HTTP Code: <code>400 Bad Request</code></p> <div class="language-json extra-class"><pre class="language-json"><code>    <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;The :payloadType payload provided is malformed. :syntaxErrorHelper.&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;malformed_payload&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;invalid_request&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;link&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://docs.meilisearch.com/errors#malformed_payload&quot;</span>
</code></pre></div><ul><li>The <code>:payloadType</code> is inferred when the message is generated. e.g. <code>json</code>, <code>ndjson</code>, <code>csv</code></li> <li>The <code>:syntaxErrorHelper</code> is inferred when the message is generated.</li></ul> <hr> <h2 id="_2-technical-details"><a href="#_2-technical-details" class="header-anchor">#</a> 2. Technical details</h2> <p>n/a</p> <h2 id="_3-future-possibilities"><a href="#_3-future-possibilities" class="header-anchor">#</a> 3. Future possibilities</h2> <ul><li>Provide an interface in the future dashboard to upload CSV data into an index and optionally provide the headers types.</li> <li>Set a payload limit directly related to the type of data format. Currently, the payload size is equivalent to <a href="https://docs.meilisearch.com/reference/features/configuration.html#payload-limit-size" target="_blank" rel="noopener noreferrer">JSON payload size<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Metrics on feature usage and configuration update should help to choose a better suited value for this type of data format.</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/specifications/text/0001-script-based-tokenizer.html" class="prev">
        Script based tokenizer
      </a></span> <span class="next"><a href="/specifications/text/0029-indexing-ndjson.html">
        Indexing ndjson
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e6676148.js" defer></script><script src="/assets/js/3.4da56047.js" defer></script><script src="/assets/js/15.095125b3.js" defer></script>
  </body>
</html>
