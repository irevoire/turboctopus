(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{488:function(t,e,a){"use strict";a.r(e);var s=a(62),i=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"snapshots-api-and-cli"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#snapshots-api-and-cli"}},[t._v("#")]),t._v(" Snapshots API and CLI")]),t._v(" "),a("h2",{attrs:{id:"_1-summary"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-summary"}},[t._v("#")]),t._v(" 1. Summary")]),t._v(" "),a("p",[t._v("A snapshot is a compressed file containing an export of a MeiliSearch instance. It contains all indexes, documents, settings, tasks, and API keys.")]),t._v(" "),a("h2",{attrs:{id:"_2-motivation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-motivation"}},[t._v("#")]),t._v(" 2. Motivation")]),t._v(" "),a("p",[t._v("The snapshots exist to start a MeiliSearch instance from a database as fast as possible. It can be a helpful tool for loading a production state on a staging server to make changes and test them before propagating them to production.")]),t._v(" "),a("h2",{attrs:{id:"_3-functional-specification"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-functional-specification"}},[t._v("#")]),t._v(" 3. Functional Specification")]),t._v(" "),a("h3",{attrs:{id:"_3-1-summary-key-points"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-summary-key-points"}},[t._v("#")]),t._v(" 3.1. Summary Key Points")]),t._v(" "),a("ul",[a("li",[t._v("A snapshot creation can be scheduled from the MeiliSearch API using the "),a("code",[t._v("POST - /snapshots")]),t._v(" endpoint.")]),t._v(" "),a("li",[t._v("A snapshot creation status can be tracked using the "),a("code",[t._v("GET - /tasks/:task_uid")]),t._v(" endpoint.")]),t._v(" "),a("li",[t._v("MeiliSearch will autobatch all your snapshots requests into one.")]),t._v(" "),a("li",[t._v("By default, snapshots are created in a folder named "),a("code",[t._v("snapshots")]),t._v(", and can be found in the same directory as the MeiliSearch binary.")]),t._v(" "),a("li",[t._v("The "),a("code",[t._v("snapshots")]),t._v(" directory can be customized using the "),a("code",[t._v("--snapshot-dir")]),t._v(" configuration option. If the snapshot directory does not already exist when the snapshot creation process is called, MeiliSearch will create it.")]),t._v(" "),a("li",[t._v("A "),a("code",[t._v(".snapshot")]),t._v(" file can be imported using the "),a("code",[t._v("--import-snapshot")]),t._v(" command-line flag.")]),t._v(" "),a("li",[t._v("The MeiliSearch server starts when the snapshot is fully imported.")]),t._v(" "),a("li",[t._v("By default, importing a snapshot when a database already exists (a non-empty "),a("code",[t._v("data.ms")]),t._v(" folder in the same directory as the MeiliSearch binary) will stop the process and throw an error.")]),t._v(" "),a("li",[t._v("When using the command-line flag "),a("code",[t._v("--ignore-snapshot-if-db-exists=true")]),t._v(", MeiliSearch will use the existing database to start an instance instead of throwing an error. The snapshot will be ignored.")]),t._v(" "),a("li",[t._v("By default, trying to import a snapshot that does not exist, will stop the process and throw an error.")]),t._v(" "),a("li",[t._v("When using the command-line flag "),a("code",[t._v("--ignore-missing-snapshot")]),t._v(", MeiliSearch will continue its process and not throw an error.")]),t._v(" "),a("li",[t._v("When a snapshot is being imported, the http API is not available. Meilisearch can't receive read or write requests.")]),t._v(" "),a("li",[a("code",[t._v("snapshotCreation")]),t._v(" task takes priority over enqueued "),a("code",[t._v("tasks")]),t._v(". This means that if a "),a("code",[t._v("snapshotCreation")]),t._v(" task is created, it will be directly processed when the current processing task finishes even if other tasks have been enqueued before.")])]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"_3-2-snapshots-api-definition"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-snapshots-api-definition"}},[t._v("#")]),t._v(" 3.2. Snapshots API Definition")]),t._v(" "),a("h4",{attrs:{id:"_3-2-1-post-snapshot"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-post-snapshot"}},[t._v("#")]),t._v(" 3.2.1. POST "),a("code",[t._v("/snapshot")])]),t._v(" "),a("p",[t._v("Create a snapshot")]),t._v(" "),a("h5",{attrs:{id:"_3-2-1-1-body-payload"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-1-body-payload"}},[t._v("#")]),t._v(" 3.2.1.1. Body Payload")]),t._v(" "),a("p",[t._v("N/A")]),t._v(" "),a("h5",{attrs:{id:"_3-2-1-2-response-definition"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-2-response-definition"}},[t._v("#")]),t._v(" 3.2.1.2. Response Definition")]),t._v(" "),a("p",[t._v("When the request is successful, Meilisearch returns the HTTP code "),a("code",[t._v("202 Accepted")]),t._v(". The response's content is the summarized representation of the received asynchronous task.")]),t._v(" "),a("p",[t._v("See "),a("RouterLink",{attrs:{to:"/specifications/text/0060-tasks-api.html#summarized-task-object-for-202-accepted"}},[t._v("Summarized "),a("code",[t._v("task")]),t._v(" Object for "),a("code",[t._v("202 Accepted")])]),t._v(".")],1),t._v(" "),a("p",[t._v("The name of the generated snapshot is the database path ("),a("code",[t._v("data.ms")]),t._v(" by default), joined by the "),a("code",[t._v(".snapshot")]),t._v(" extension. By default, it's "),a("code",[t._v("data.ms.snapshot")]),t._v(".")]),t._v(" "),a("h5",{attrs:{id:"_3-2-1-3-errors"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-3-errors"}},[t._v("#")]),t._v(" 3.2.1.3. Errors")]),t._v(" "),a("ul",[a("li",[t._v("ðŸ”´ If Meilisearch is secured, accessing this route without the "),a("code",[t._v("Authorization")]),t._v(" header returns a "),a("RouterLink",{attrs:{to:"/specifications/text/0061-error-format-and-definitions.html#missing_authorization_header"}},[t._v("missing_authorization_header")]),t._v(" error.")],1),t._v(" "),a("li",[t._v("ðŸ”´ If Meilisearch is secured, accessing this route with a key that does not have permissions (i.e. other than the master-key) returns an "),a("RouterLink",{attrs:{to:"/specifications/text/0061-error-format-and-definitions.html#invalid_api_key"}},[t._v("invalid_api_key")]),t._v(" error.")],1)]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"_3-3-cli-definition"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-cli-definition"}},[t._v("#")]),t._v(" 3.3. CLI Definition")]),t._v(" "),a("p",[t._v("You can find the CLI informations about the snapshots "),a("RouterLink",{attrs:{to:"/specifications/text/text/0119-instance-options.html"}},[t._v("here")])],1),t._v(" "),a("h2",{attrs:{id:"_4-technical-aspects"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-technical-aspects"}},[t._v("#")]),t._v(" 4. Technical Aspects")]),t._v(" "),a("h3",{attrs:{id:"_4-1-snapshot-creation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-snapshot-creation"}},[t._v("#")]),t._v(" 4.1. Snapshot Creation")]),t._v(" "),a("p",[t._v("When a snapshot is being created, the task queue can receive other future operations to perform.")]),t._v(" "),a("h3",{attrs:{id:"_4-2-importing-a-snapshot"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-importing-a-snapshot"}},[t._v("#")]),t._v(" 4.2. Importing a snapshot")]),t._v(" "),a("p",[t._v("When a snapshot is being imported, the http API is not available. Meilisearch can't receive read or write requests.")]),t._v(" "),a("h3",{attrs:{id:"_4-3-snapshot-creation-task-priority"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-snapshot-creation-task-priority"}},[t._v("#")]),t._v(" 4.3. Snapshot Creation Task Priority")]),t._v(" "),a("p",[t._v("Snapshot creation tasks have priority over other task types. If a "),a("code",[t._v("snapshotCreation")]),t._v(" task is enqueued, it will be directly processed when the current processing task finishes even if other tasks have been enqueued before.")]),t._v(" "),a("h2",{attrs:{id:"_5-future-possibilities"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-future-possibilities"}},[t._v("#")]),t._v(" 5. Future Possibilities")]),t._v(" "),a("ul",[a("li",[t._v("Give information about who created the task (is it scheduled or created on a user demand) in the details.")])])])}),[],!1,null,null,null);e.default=i.exports}}]);